% Right hand side of wrench constraints which enforce Newton's second law
% in x, y, and rotational directions
function RHS = wrench_equation(wrench_nominal,Constraint_Jacobian,A_lin,...
    B_lin,u,x_out,utilize_compliance)

    global time_step 
    x_out = x_out(1,:);
    if utilize_compliance == 1      
        RHS = (wrench_nominal'+(Constraint_Jacobian*[0,1,0,1,0,0,0,0;0,0,0,0,0,1,0,1]*...
        (B_lin*u'+(A_lin-eye(8,8))*x_out')*(1/time_step))');
    else
        RHS = (wrench_nominal'+(Constraint_Jacobian*[0,1,0,0;0,0,0,1]*...
        (B_lin*u'+(A_lin-eye(4,4))*x_out')*(1/time_step))');        
    end
    
end 